<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>URL Parser</title>
        <meta name="description" content="Form to insert and analyze URLs.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
        <style>
            body {
                padding-top: 20px;
                background-color: #444;
                color: #d4d4d4;
                font-family: sans-serif;
            }
            h1, h2, label {
                color: #d4d4d4;
                text-align: center;
            }
            #urlForm {
                margin-bottom: 20px;
            }
            #output-container {
                margin-top: 20px;
            }
            .url-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 10px;
                color: #d4d4d4;
                background-color: #1e1e1e;
                font-family: monospace;
            }
            .url-table th, .url-table td {
                padding: 8px;
                text-align: left;
            }
            .url-table tr:nth-child(odd) {
                background-color: #222;
            }
            .url-table tr:nth-child(even) {
                background-color: #282828;
            }
            .url-table td:first-child {
                font-weight: bold;
                background-color: #222;
            }
            .url-table tr:nth-child(even) td:first-child {
                background-color: #282828;
            }
            .url-table td:nth-child(2) {
                color: #ccc;
                background-color: #333;
            }
            .url-table tr:nth-child(even) td:nth-child(2) {
                background-color: #3a3a3a;
            }
            .form-control {
                background-color: #1e1e1e;
                color: #d4d4d4;
                border: 1px solid #555;
                font-family: monospace;
            }
            .form-control:focus {
                background-color: #1e1e1e;
                color: #baff33;
                border-color: #baff33;
                box-shadow: 0 0 0 0.2rem rgba(186, 255, 51, 0.25);
            }
            .form-control::placeholder {
                color: #999;
                font-family: monospace;
            }
            .btn-primary {
                display: block;
                width: 100%;
                background-color: #007bff;
                border-color: #007bff;
                color: #fff;
            }
            .btn-primary:hover {
                background-color: #0056b3;
                border-color: #0056b3;
            }
            .param-key {
                font-weight: bold;
            }
            .url-link {
                color: inherit;
                text-decoration: none;
            }
            .url-link:hover {
                color: #baff33;
                text-decoration: underline;
            }
            .sub-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 5px;
            }
            .sub-table td {
                padding: 5px;
                text-align: left;
                font-size: 0.9em;
                border: none;
            }
            .sub-table tr {
                background-color: transparent !important;
            }
            .sub-table .param-key-sub {
                font-weight: bold;
                color: #eee;
                margin-right: 5px;
            }

            @media (max-width: 767px) {
                .url-table th, .url-table td {
                    display: block;
                    width: 100%;
                    box-sizing: border-box;
                }
                .url-table tr {
                    margin-bottom: 2px;
                    display: block;
                    padding: 10px;
                    border-left: 2px solid #333;
                    border-right: 2px solid #333;
                }
                .url-table td:first-child {
                    border-top: 2px solid #333;
                    padding-bottom: 0;
                }
                .url-table td:nth-child(2) {
                    border-bottom: 2px solid #333;
                    padding-top: 0;
                }
            }

            @media (min-width: 768px) {
                .url-table {
                    display: table;
                }
                .url-table tr {
                    display: table-row;
                    border: none;
                    padding: 0;
                    margin-bottom: 0;
                }
                .url-table th, .url-table td {
                    display: table-cell;
                    width: auto;
                    box-sizing: content-box;
                    border-left: 2px solid #333;
                    border-right: 2px solid #333;
                }
                .url-table thead th {
                    border-bottom: 2px solid #333;
                }
                .url-table tbody td {
                    border-bottom: 1px solid #333;
                }
                .url-table tbody tr:last-child td {
                    border-bottom: none;
                }
                .url-table td:first-child {
                    width: 150px;
                    padding-bottom: 8px;
                    border-left: none;
                }
                .url-table td:nth-child(2) {
                    padding-top: 8px;
                    border-right: none;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>URL Parser</h1>
            <form id="urlForm">
                <div class="form-group">
                    <label for="urlInput">Enter URL:</label>
                    <input type="text" class="form-control" id="urlInput" placeholder="https://example.com/path?param=value#fragment">
                </div>
                <button type="button" class="btn btn-primary" id="parseButton">Parse</button>
            </form>

            <div id="output-container" class="mt-4">
                <h2>Analysis Result:</h2>
                <table id="parsedResult" class="url-table">
                    <tbody>
                        </tbody>
                </table>
            </div>
        </div>

        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script>
            const parseUrl = (url) => {
                const RegExp = {
                    UrlParts: /^((?:https?:\/\/)?[^\/]+\.[^\/]+)((?:\/[^\/?#]*)*)(\?\S*?)?(#\S*)?$/}
                url = url.replaceAll('\\', '');
                if (RegExp.UrlParts.test(url)) {
                    const groups = RegExp.UrlParts.exec(url);
                    let parameters_list = [];
                    if (groups[3]) {
                        parameters_list = groups[3].slice(1).split('&');}
                    let parameters_obj = {};
                    if (parameters_list.length) {
                        parameters_list.forEach(e => {
                            const [key, value] = e.split('=');
                            parameters_obj[key] = value;})}
                    let fragment_list = [];
                    if (groups[4]) {
                        fragment_list = groups[4].slice(1).split('&');}
                    let fragment_obj = {};
                    if (fragment_list.length) {
                        fragment_list.forEach(e => {
                            const [key, value] = e.split('=');
                            fragment_obj[key] = value;})}
                    return {
                        parts: {
                            domain: groups[1],
                            path: groups[2] || '',
                            parameters: {
                                str: groups[3] || '',
                                list: parameters_list,
                                obj: parameters_obj},
                            fragment: {
                                str: groups[4] || '',
                                list: fragment_list,
                                obj: fragment_obj}},
                        fullUrl: function() {
                            return this.parts.domain + (this.parts.path || '') +
                                (this.parts.parameters.str || '') +
                                (this.parts.fragment.str || '')}};}
                return undefined;}

            document.addEventListener('DOMContentLoaded', function() {
                const parseButton = document.getElementById('parseButton');
                const urlInput = document.getElementById('urlInput');
                const parsedResultTableBody = document.querySelector('#parsedResult tbody');

                parseButton.addEventListener('click', function() {
                    const url = urlInput.value.replaceAll('\\', '');
                    const r = parseUrl(url);
                    parsedResultTableBody.innerHTML = '';

                    if (!r) {
                        const row = parsedResultTableBody.insertRow();
                        const cell = row.insertCell();
                        cell.colSpan = 2;
                        cell.textContent = "Invalid URL.";
                        return;
                    }

                    const addTableRow = (label, value) => {
                        const row = parsedResultTableBody.insertRow();
                        const labelCell = row.insertCell();
                        const valueCell = row.insertCell();
                        labelCell.textContent = label;
                        valueCell.innerHTML = value || '-';
                    };

                    const domain = r.parts.domain;
                    const fullUrl = r.fullUrl();

                    addTableRow("Domain", `<a href="${domain}" class="url-link">${domain}</a>`);
                    addTableRow("Path", r.parts.path);

                    if (r.parts.parameters.list.length > 0) {
                        addTableRow("Parameters", r.parts.parameters.str);
                        let paramsSubTable = '<table class="sub-table">';
                        for (const key in r.parts.parameters.obj) {
                            paramsSubTable += `<tr><td><span class="param-key-sub">${key}</span></td><td>${r.parts.parameters.obj[key] || ''}</td></tr>`;
                        }
                        paramsSubTable += '</table>';
                        addTableRow("Detailed Parameters", paramsSubTable);
                    }

                    if (r.parts.fragment.list.length > 0) {
                        addTableRow("Fragment", r.parts.fragment.str);
                        let fragmentSubTable = '<table class="sub-table">';
                        for (const key in r.parts.fragment.obj) {
                            fragmentSubTable += `<tr><td><span class="param-key-sub">${key}</span></td><td>${r.parts.fragment.obj[key] || ''}</td></tr>`;
                        }
                        fragmentSubTable += '</table>';
                        addTableRow("Detailed Fragment", fragmentSubTable);
                    }

                    addTableRow("Full URL", `<a href="${fullUrl}" class="url-link">${fullUrl}</a>`);
                });
            });
        </script>
    </body>
</html>